<!DOCTYPE html>
<html data-theme="light"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta name="description" content="Examples of how to use timezone aware datetimes in Python">
    <meta name="keywords" content="python, datetime, pytz">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
    <link href="/css/main.css" rel="stylesheet"/>
    <title>Timezone Aware Timestamps in Python ~ MOK&#39;s Onomatomaniske Kaos</title>
</head>
<body><header data-theme="dark" >
  <span id="header__title">
    MOK&#39;s Onomatomaniske Kaos
  </span>
  <div id="header__subtitle">
        Super Cool
  </div><nav class="site-nav">
  <ul class="main-menu">
    
    <li>
      <a href="/"  data-theme="dark" class="contrast">Home</a>
    </li>
    
    <li>
      <a href="/posts"  data-theme="dark" class="contrast">Posts</a>
    </li>
    
    <li>
      <a href="/about"  data-theme="dark" class="contrast">About</a>
    </li>
    
  </ul>
</nav>
</header>
<div id="content">
<main class=container>
  <div class="grid">
    <div class="article__title">
      <h2>Timezone Aware Timestamps in Python</h2>
    </div>

    <div class="article__categories"><span><i class="fa fa-list"></i></span>
      <a class="article__category" href="/categories/python">Python</a>
    </div> 

  </div> 

  
    <div class="article__date">2024-07-19 22:57</div>
  
  <div class="article__author">Morten Kjeldgaard</div>

  <hr />
  <div class="content">
    <p>The datetime object in Python is very powerful, but if you want to do serious timeseries analysis and use data from around the world, you need to use timezone aware <code>datetime</code> objects, and these are not the default.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> <span style="color:#111">datetime</span> <span style="color:#00a8c8">as</span> <span style="color:#111">dt</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">now</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#f92672">.</span><span style="color:#111">now</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">now</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">16</span><span style="color:#111">:</span><span style="color:#ae81ff">03</span><span style="color:#111">:</span><span style="color:#ae81ff">40.991009</span>
</span></span></code></pre></div><p>This is the current time, however the datetime object we have is not timezone aware, and the <code>tzinfo</code> object has the value <code>None</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">now</span><span style="color:#f92672">.</span><span style="color:#111">tzinfo</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">None</span>
</span></span></code></pre></div><h2 id="the-trusty-old-way-the-pytz-module">The trusty old way: The <code>pytz</code> module</h2>
<p>Let us assume the dates you have are from a dataset and you determine they are relative to the <code>US/Eastern</code> timezone. We need to add the timezone information to the datetime object, and this can be done most easily using the <code>pytz</code> module. The <code>datetime</code> module can also deal with timezones, but it is cumbersome and convoluted to use by itself. With the <code>pytz</code> module it becomes much easier, and this module is very popular. However, <code>pytz</code> is not a module in Python&rsquo;s standard library, so you need to install it using <code>pip install pytz</code> or perhaps the package manager of your OS.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> <span style="color:#111">datetime</span> <span style="color:#00a8c8">as</span> <span style="color:#111">dt</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">now</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#ae81ff">16</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">now</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">16</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>The time is given by date and hours and minutes, but there is no information about the timezone, this timepoint could be anywhere in the world. Now let us localize the <code>datetime</code> object. We set the timezone to <code>US/Eastern</code>, and use the <code>localize</code> functionality from <code>pytz</code> to do the conversion. This date is in the summer, so daylight savings time is taken into account when deciding the offset in hours from UTC:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> <span style="color:#111">pytz</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">now_tzaware</span> <span style="color:#f92672">=</span> <span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">timezone</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">localize</span><span style="color:#111">(</span><span style="color:#111">now</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">now_tzaware</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">16</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>As you can see, the time is unchanged (still 16:00 or 4 pm) but now timezone information has been offset of -4 hours. This is useful when you have the local wall time and wish to add timezone information.</p>
<p>Next, let us convert this <code>datetime</code> object to UTC time. It is commonly an advantage to define times in the UTC timezone, and convert it to localtime if you need it. This is using a method of the <code>datetime</code> class, <code>astimezone()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">now_utc</span> <span style="color:#f92672">=</span> <span style="color:#111">now_tzaware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">UTC</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">now_utc</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">20</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>Notice that the time is the same, but now in the UTC timezone, which is +4 hours offset with respect to the US/Eastern time zone, so the time is now given as 20:00 hours (8 PM).</p>
<h3 id="daylight-savings-time">Daylight savings time</h3>
<p>The <code>pytz</code> module deals sensibly with daylight savings time. Let us define two dates, one in the winter and the other in the summer. These <code>datetime</code>  objects are initially without timezone information, this is often referred to as a &ldquo;naive&rdquo; object:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">winter_naive</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">summer_naive</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;winter_naive:&#34;</span><span style="color:#111">,</span> <span style="color:#111">winter_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">winter_naive</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;summer_naive:&#34;</span><span style="color:#111">,</span> <span style="color:#111">summer_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">summer_naive</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>Now let us make these <code>datetime</code> objects timezone aware, again we use the <code>localize()</code> function from <code>pytz</code> to achieve this:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">summer_aware</span> <span style="color:#f92672">=</span> <span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">timezone</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">localize</span><span style="color:#111">(</span><span style="color:#111">summer_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">winter_aware</span> <span style="color:#f92672">=</span> <span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">timezone</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">localize</span><span style="color:#111">(</span><span style="color:#111">winter_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">winter_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>As you can see, due to daylight saving, the UTC offset is -4 hours in the winter and -5 in the summer.</p>
<h3 id="beware-of-local-mean-time--lmt">Beware of Local Mean Time (LMT)</h3>
<p>A <code>pytz</code> timezone class does not represent a single offset from UTC, it represents a geographical area with an offset that varies. The average time offset for this area is called &ldquo;Local Mean Time&rdquo; (LMT) and is an offset from UTC by a number of minutes. If you do not use the <code>localize()</code> function from <code>pytz</code> you might get the LMT offset in the timezone aware <code>datetime</code> object. This is how that looks, first we save the <code>tzinfo</code> object in a variable <code>eastern</code>, and next use that to generate a timezone aware object, by directly attaching the <code>tzinfo</code> object:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">eastern</span> <span style="color:#f92672">=</span> <span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">timezone</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">summer_aware2</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">tzinfo</span><span style="color:#f92672">=</span><span style="color:#111">eastern</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#111">:</span><span style="color:#ae81ff">56</span>
</span></span></code></pre></div><p>As you can see, the UTC offset is now 4 hours and 56 minutes, and not a whole number of hours, and it does not take DST into account. This is evident if we convert to UTC:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">UTC</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">16</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware2</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">pytz</span><span style="color:#f92672">.</span><span style="color:#111">UTC</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">16</span><span style="color:#111">:</span><span style="color:#ae81ff">56</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>Therefore, it is not recommended to define the timezone in this way, as it may be confusing. The representation of the <code>summer_aware</code> object has details about the LMT setting of this object:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">repr</span><span style="color:#111">(</span><span style="color:#111">summer_aware2</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span><span style="color:#111">datetime</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">tzinfo</span><span style="color:#f92672">=&lt;</span><span style="color:#111">DstTzInfo</span> <span style="color:#d88200">&#39;US/Eastern&#39;</span> <span style="color:#111">LMT</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#111">day</span><span style="color:#111">,</span> <span style="color:#ae81ff">19</span><span style="color:#111">:</span><span style="color:#ae81ff">04</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span> <span style="color:#111">STD</span><span style="color:#f92672">&gt;</span><span style="color:#111">)</span>
</span></span></code></pre></div><h2 id="the-new-way-the-built-in-zoneinfo-module">The new way: The built-in <code>zoneinfo</code> module</h2>
<p>Since version 3.9, Python comes with the <a href="https://docs.python.org/3/library/zoneinfo.html">ZoneInfo</a> module built-in. The <code>pytz</code> module we have used until now works well, but is a third party module that you need to install with <code>pip</code>.</p>
<p>Let&rsquo;s check out the ZoneInfo module, and especially how it behaves with daylight savings time. We&rsquo;ll declare a couple of dates, one in the winter, the other in the summer.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> <span style="color:#111">datetime</span> <span style="color:#00a8c8">as</span> <span style="color:#111">dt</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">from</span> <span style="color:#111">zoneinfo</span> <span style="color:#f92672">import</span> <span style="color:#111">ZoneInfo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">winter_naive</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">summer_naive</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;winter_naive:&#34;</span><span style="color:#111">,</span> <span style="color:#111">winter_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">winter_naive</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;summer_naive:&#34;</span><span style="color:#111">,</span> <span style="color:#111">summer_naive</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">summer_naive</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>The naive objects contain the date and time we expect. Now let&rsquo;s specify these according to the local timezone:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">winter_aware</span> <span style="color:#f92672">=</span> <span style="color:#111">winter_naive</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">summer_aware</span> <span style="color:#f92672">=</span> <span style="color:#111">summer_naive</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;winter_aware:&#34;</span><span style="color:#111">,</span> <span style="color:#111">winter_aware</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">winter_aware</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;summer_aware:&#34;</span><span style="color:#111">,</span> <span style="color:#111">summer_aware</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#111">summer_aware</span><span style="color:#111">:</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">12</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">02</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>The time at noon is unchanged, but the offset from UTC is specified. Notice that in this case, the timezone is +1 hour in the winter and +2 hours in the summer. Now let&rsquo;s convert these times to UTC. We now get to use the <code>ZoneInfo</code> module.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Convert to UTC&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">winter_aware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;UTC&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;UTC&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span><span style="color:#111">Convert</span> <span style="color:#111">to</span> <span style="color:#111">UTC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">11</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">10</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>These times are correct, also in the UTC timezone. Let&rsquo;s try converting to US/Eastern timezone:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Convert to US/Eastern&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">winter_aware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">summer_aware</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;US/Eastern&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span><span style="color:#111">Convert</span> <span style="color:#111">to</span> <span style="color:#111">US</span><span style="color:#f92672">/</span><span style="color:#111">Eastern</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">06</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">06</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>The times are still correct, the timestamp is the same, but of course the walltime is different in Europe and in Eastern US.</p>
<p>Now, let&rsquo;s do something that might fail, and that is taking time deltas across daylight savings time. We&rsquo;ll define two timezone aware timestamps, two minutes apart, at the time point where daylight savings time began in Europe in 2024.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">just_before_dst</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span><span style="color:#ae81ff">31</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span><span style="color:#ae81ff">59</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">just_after_dst</span> <span style="color:#f92672">=</span> <span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">datetime</span><span style="color:#111">(</span><span style="color:#ae81ff">2024</span><span style="color:#111">,</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span><span style="color:#ae81ff">31</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">()</span>
</span></span></code></pre></div><p>So, just after DST changes, the time is 02:01, right? Let&rsquo;s print out these objects and check:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;1 minute before dst&#34;</span><span style="color:#111">,</span> <span style="color:#111">just_before_dst</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#d88200">&#34;1 minute after dst&#34;</span><span style="color:#111">,</span> <span style="color:#111">just_after_dst</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#111">minute</span> <span style="color:#111">before</span> <span style="color:#111">dst</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">59</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#111">minute</span> <span style="color:#111">after</span> <span style="color:#111">dst</span> <span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">03</span><span style="color:#111">:</span><span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">02</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>Notice that the timestamp immediately after DST begins is set at 03:01, which is correct. We tried to set the time to 02:01, but that timepoint simply doesn&rsquo;t exist. Fortunately the module corrected our mistake silently. Now lets print the difference in time between 01:59 before DST and 03:01 after DST:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">just_after_dst</span> <span style="color:#f92672">-</span> <span style="color:#111">just_before_dst</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#111">:</span><span style="color:#ae81ff">02</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>The result is two minutes, which is correct! Let&rsquo;s try to convert these to timestamps to UTC time and see what happens.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Convert to UTC</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">just_before_dst_utc</span> <span style="color:#f92672">=</span> <span style="color:#111">just_before_dst</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;UTC&#39;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#111">just_after_dst_utc</span> <span style="color:#f92672">=</span> <span style="color:#111">just_after_dst</span><span style="color:#f92672">.</span><span style="color:#111">astimezone</span><span style="color:#111">(</span><span style="color:#111">ZoneInfo</span><span style="color:#111">(</span><span style="color:#d88200">&#39;UTC&#39;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">59</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">01</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>Now both timestamps have been converted to UTC, and the difference:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">just_after_dst_utc</span><span style="color:#f92672">-</span><span style="color:#111">just_before_dst_utc</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#111">:</span><span style="color:#ae81ff">02</span><span style="color:#111">:</span><span style="color:#ae81ff">00</span>
</span></span></code></pre></div><p>is still 2 minutes.</p>
<p>So, it seems if you are using timezone aware <code>datetime</code> objects, things are pretty safe. However the topic of time is a complex one. The obvious answer, to always use timezone aware timestamps is however not always correct, since timezones change all the time, and DST may be abolished in the future. So a time marking is a volatile and subjective piece of data.</p>
<p>Joël Perras recently wrote a related <a href="https://nerderati.com/a-python-epoch-timestamp-timezone-trap/">blog post</a> on his site Nerderati describing the pitfalls you can encounter especially when using UNIX timestamps intermixed with Python <code>datetime</code> objects.</p>
  </div> 

  <div class="article__tags"><a class="article__tag" href="/tags/datetime">#datetime </a><a class="article__tag" href="/tags/timezone">#timezone </a><a class="article__tag" href="/tags/python">#python </a><a class="article__tag" href="/tags/dst">#DST </a>
  </div> 
</main> 

        </div><footer data-theme="dark" >
  <span id="footer__title">
    © Morten Kjeldgaard, 2025
  </span>
</footer>
<script src="https://kit.fontawesome.com/e55e3b2e7b.js" crossorigin="anonymous"></script>
<script src="/js/main.js"></script>
</body>
</html>
